# frozen_string_literal: true

# app/presenters/integrations/stripo/presenter.rb
module Integrations
  module Stripo
    class Presenter
      attr_accessor :current_template_category

      def initialize
        @current_template_category = nil
        @email_template_categories = nil
        @email_templates           = nil
        @merge_tags                = nil
      end

      def base_css_string
        "/* CONFIG STYLES Please do not delete and edit CSS styles below */\r\n/* IMPORTANT THIS STYLES MUST BE ONFINAL EMAIL */\r\n#outlook a {\r\n\tpadding: 0;\r\n}\r\n.es-button {\r\n\tmso-style-priority: 100 !important;\r\n\ttext-decoration: none !important;\r\n}\r\na[x-apple-data-detectors] {\r\n\tcolor: inherit !important;\r\n\ttext-decoration: none !important;\r\n\tfont-size: inherit !important;\r\n\tfont-family: inherit !important;\r\n\tfont-weight: inherit !important;\r\n\tline-height: inherit !important;\r\n}\r\n.es-desk-hidden {\r\n\tdisplay: none;\r\n\tfloat: left;\r\n\toverflow: hidden;\r\n\twidth: 0;\r\n\tmax-height: 0;\r\n\tline-height: 0;\r\n\tmso-hide: all;\r\n}\r\n/*\r\nEND OF IMPORTANT\r\n*/\r\nbody {\r\n\twidth: 100%;\r\n\tfont-family: arial, 'helvetica neue', helvetica, sans-serif;\r\n\t-webkit-text-size-adjust: 100%;\r\n\t-ms-text-size-adjust: 100%;\r\n}\r\ntable {\r\n\tmso-table-lspace: 0pt;\r\n\tmso-table-rspace: 0pt;\r\n\tborder-collapse: collapse;\r\n\tborder-spacing: 0px;\r\n}\r\ntable td,\r\nbody,\r\n.es-wrapper {\r\n\tpadding: 0;\r\n\tMargin: 0;\r\n}\r\n.es-content,\r\n.es-header,\r\n.es-footer {\r\n\ttable-layout: fixed !important;\r\n\twidth: 100%;\r\n}\r\nimg {\r\n\tdisplay: block;\r\n\tborder: 0;\r\n\toutline: none;\r\n\ttext-decoration: none;\r\n\t-ms-interpolation-mode: bicubic;\r\n}\r\np,\r\nhr {\r\n\tMargin: 0;\r\n}\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5 {\r\n\tMargin: 0;\r\n\tline-height: 120%;\r\n\tmso-line-height-rule: exactly;\r\n\tfont-family: arial, 'helvetica neue', helvetica, sans-serif;\r\n}\r\np,\r\nul li,\r\nol li,\r\na {\r\n\t-webkit-text-size-adjust: none;\r\n\t-ms-text-size-adjust: none;\r\n\tmso-line-height-rule: exactly;\r\n}\r\n.es-left {\r\n\tfloat: left;\r\n}\r\n.es-right {\r\n\tfloat: right;\r\n}\r\n.es-p5 {\r\n\tpadding: 5px;\r\n}\r\n.es-p5t {\r\n\tpadding-top: 5px;\r\n}\r\n.es-p5b {\r\n\tpadding-bottom: 5px;\r\n}\r\n.es-p5l {\r\n\tpadding-left: 5px;\r\n}\r\n.es-p5r {\r\n\tpadding-right: 5px;\r\n}\r\n.es-p10 {\r\n\tpadding: 10px;\r\n}\r\n.es-p10t {\r\n\tpadding-top: 10px;\r\n}\r\n.es-p10b {\r\n\tpadding-bottom: 10px;\r\n}\r\n.es-p10l {\r\n\tpadding-left: 10px;\r\n}\r\n.es-p10r {\r\n\tpadding-right: 10px;\r\n}\r\n.es-p15 {\r\n\tpadding: 15px;\r\n}\r\n.es-p15t {\r\n\tpadding-top: 15px;\r\n}\r\n.es-p15b {\r\n\tpadding-bottom: 15px;\r\n}\r\n.es-p15l {\r\n\tpadding-left: 15px;\r\n}\r\n.es-p15r {\r\n\tpadding-right: 15px;\r\n}\r\n.es-p20 {\r\n\tpadding: 20px;\r\n}\r\n.es-p20t {\r\n\tpadding-top: 20px;\r\n}\r\n.es-p20b {\r\n\tpadding-bottom: 20px;\r\n}\r\n.es-p20l {\r\n\tpadding-left: 20px;\r\n}\r\n.es-p20r {\r\n\tpadding-right: 20px;\r\n}\r\n.es-p25 {\r\n\tpadding: 25px;\r\n}\r\n.es-p25t {\r\n\tpadding-top: 25px;\r\n}\r\n.es-p25b {\r\n\tpadding-bottom: 25px;\r\n}\r\n.es-p25l {\r\n\tpadding-left: 25px;\r\n}\r\n.es-p25r {\r\n\tpadding-right: 25px;\r\n}\r\n.es-p30 {\r\n\tpadding: 30px;\r\n}\r\n.es-p30t {\r\n\tpadding-top: 30px;\r\n}\r\n.es-p30b {\r\n\tpadding-bottom: 30px;\r\n}\r\n.es-p30l {\r\n\tpadding-left: 30px;\r\n}\r\n.es-p30r {\r\n\tpadding-right: 30px;\r\n}\r\n.es-p35 {\r\n\tpadding: 35px;\r\n}\r\n.es-p35t{\r\n\tpadding-top: 35px;\r\n}\r\n.es-p35b {\r\n\tpadding-bottom: 35px;\r\n}\r\n.es-p35l {\r\n\tpadding-left: 35px;\r\n}\r\n.es-p35r {\r\n\tpadding-right: 35px;\r\n}\r\n.es-p40 {\r\n\tpadding:40px;\r\n}\r\n.es-p40t {\r\n\tpadding-top: 40px;\r\n}\r\n.es-p40b {\r\n\tpadding-bottom: 40px;\r\n}\r\n.es-p40l {\r\n\tpadding-left: 40px;\r\n}\r\n.es-p40r {\r\n\tpadding-right: 40px;\r\n}\r\n.es-menu td {\r\n\tborder: 0;\r\n}\r\n.es-menu td a img {\r\n\tdisplay: inline-block !important;\r\n\tvertical-align: middle;\r\n}\r\n/*\r\nEND CONFIG STYLES\r\n*/\r\ns {\r\n\ttext-decoration: line-through;\r\n}\r\np,\r\nul li,\r\nol li {\r\n\tfont-family: arial, 'helvetica neue', helvetica, sans-serif;\r\n\tline-height: 150%;\r\n}\r\nul li,\r\nol li {\r\n\tMargin-bottom: 15px;\r\n\tmargin-left: 0;\r\n}\r\na {\r\n\ttext-decoration: underline;\r\n}\r\n.es-menu td a {\r\n\ttext-decoration: none;\r\n\tdisplay: block;\r\n\tfont-family: arial, 'helvetica neue', helvetica, sans-serif;\r\n}\r\n.es-wrapper {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tbackground-image: ;\r\n\tbackground-repeat: repeat;\r\n\tbackground-position: center top;\r\n}\r\n.es-wrapper-color,\r\n.es-wrapper {\r\n\tbackground-color:#f6f6f6;\r\n}\r\n.es-header {\r\n\tbackground-color: transparent;\r\n\tbackground-image: ;\r\n\tbackground-repeat: repeat;\r\n\tbackground-position: center top;\r\n}\r\n.es-header-body {\r\n\tbackground-color: transparent;\r\n}\r\n.es-header-body p,\r\n.es-header-body ul li,\r\n.es-header-body ol li {\r\n\tcolor: #333333;\r\n\tfont-size: 14px;\r\n}\r\n.es-header-body a {\r\n\tcolor: #333333;\r\n\tfont-size: 14px;\r\n}\r\n.es-content-body {\r\n\tbackground-color: #ffffff;\r\n}\r\n.es-content-body p,\r\n.es-content-body ul li,\r\n.es-content-body ol li {\r\n\tcolor: #333333;\r\n\tfont-size: 14px;\r\n}\r\n.es-content-body a {\r\n\tcolor: #333333;\r\n\tfont-size: 14px;\r\n}\r\n.es-footer {\r\n\tbackground-color: transparent;\r\n\tbackground-image: ;\r\n\tbackground-repeat: repeat;\r\n\tbackground-position: center top;\r\n}\r\n.es-footer-body {\r\n\tbackground-color: #808080;\r\n}\r\n.es-footer-body p,\r\n.es-footer-body ul li,\r\n.es-footer-body ol li {\r\n\tcolor: #ffffff;\r\n\tfont-size: 14px;\r\n}\r\n.es-footer-body a {\r\n\tcolor: #ffffff;\r\n\tfont-size: 14px;\r\n}\r\n.es-infoblock,\r\n.es-infoblock p,\r\n.es-infoblock ul li,\r\n.es-infoblock ol li {\r\n\tline-height: 120%;\r\n\tfont-size: 12px;\r\n\tcolor: #cccccc;\r\n}\r\n.es-infoblock a {\r\n\tfont-size: 12px;\r\n\tcolor: #cccccc;\r\n}\r\nh1 {\r\n\tfont-size: 30px;\r\n\tfont-style: normal;\r\n\tfont-weight: normal;\r\n\tcolor: #333333;\r\n}\r\nh2 {\r\n\tfont-size: 24px;\r\n\tfont-style: normal;\r\n\tfont-weight: normal;\r\n\tcolor: #333333;\r\n}\r\nh3 {\r\n\tfont-size: 20px;\r\n\tfont-style: normal;\r\n\tfont-weight: normal;\r\n\tcolor: #333333;\r\n}\r\n.es-header-body h1 a,\r\n.es-content-body h1 a,\r\n.es-footer-body h1 a {\r\n\tfont-size: 30px;\r\n}\r\n.es-header-body h2 a,\r\n.es-content-body h2 a,\r\n.es-footer-body h2 a {\r\n\tfont-size: 24px;\r\n}\r\n.es-header-body h3 a,\r\n.es-content-body h3 a,\r\n.es-footer-body h3 a {\r\n\tfont-size: 20px;\r\n}\r\na.es-button,\r\nbutton.es-button {\r\n\tdisplay: inline-block;\r\n\tbackground: #f0f0f0;\r\n\tborder-radius: 0px;\r\n\tfont-size: 16px;\r\n\tfont-family: arial, 'helvetica neue', helvetica, sans-serif;\r\n\tfont-weight: normal;\r\n\tfont-style: normal;\r\n\tline-height: 120%;\r\n\tcolor: #333333;\r\n\ttext-decoration: none !important;\r\n\twidth: auto;\r\n\ttext-align: center;\r\n\tpadding: 5px 30px 5px 30px;\r\n\tmso-padding-alt: 0;\r\n\tmso-border-alt: 10px solid #f0f0f0;\r\n}\r\n.es-button-border {\r\n\tborder-style: solid solid solid solid;\r\n\tborder-color: #808080 #808080 #808080 #808080;\r\n\tbackground: #f0f0f0;\r\n\tborder-width: 2px 2px 2px 2px;\r\n\tdisplay: inline-block;\r\n\tborder-radius: 0px;\r\n\twidth: auto;\r\n}\r\n.msohide {\r\n\tmso-hide: all;\r\n}\r\n/* RESPONSIVE STYLES Please do not delete and edit CSS styles below. If you don't need responsive layout, please delete this section. */\r\n@media only screen and (max-width: 600px) {\r\n\tp,\r\n    ul li,\r\n    ol li,\r\n    a {\r\n\t\tline-height: 150% !important;\r\n\t}\r\n\th1,\r\n    h2,\r\n    h3,\r\n    h1 a,\r\n    h2 a,\r\n    h3 a {\r\n\t\tline-height: 120% !important;\r\n\t}\r\n\th1 {\r\n\t\tfont-size: 30px !important;\r\n\t\ttext-align: center;\r\n\t}\r\n\th2 {\r\n\t\tfont-size: 26px !important;\r\n\t\ttext-align: center;\r\n\t}\r\n\th3 {\r\n\t\tfont-size: 20px !important;\r\n\t\ttext-align: center;\r\n\t}\r\n\t.es-header-body h1 a,\r\n    .es-content-body h1 a,\r\n    .es-footer-body h1 a {\r\n\t\tfont-size: 30px !important;\r\n\t}\r\n\t.es-header-body h2 a,\r\n    .es-content-body h2 a,\r\n    .es-footer-body h2 a {\r\n\t\tfont-size: 26px !important;\r\n\t}\r\n\t.es-header-body h3 a,\r\n    .es-content-body h3 a,\r\n    .es-footer-body h3 a {\r\n\t\tfont-size: 20px !important;\r\n\t}\r\n\t.es-menu td a {\r\n\t\tfont-size: 13px !important;\r\n\t}\r\n\t.es-header-body p,\r\n    .es-header-body ul li,\r\n    .es-header-body ol li,\r\n    .es-header-body a {\r\n\t\tfont-size: 16px !important;\r\n\t}\r\n\t.es-content-body p,\r\n    .es-content-body ul li,\r\n    .es-content-body ol li,\r\n    .es-content-body a {\r\n\t\tfont-size: 16px !important;\r\n\t}\r\n\t.es-footer-body p,\r\n    .es-footer-body ul li,\r\n    .es-footer-body ol li,\r\n    .es-footer-body a {\r\n\t\tfont-size: 16px !important;\r\n\t}\r\n\t.es-infoblock p,\r\n    .es-infoblock ul li,\r\n    .es-infoblock ol li,\r\n    .es-infoblock a {\r\n\t\tfont-size: 12px !important;\r\n\t}\r\n\t*[class=\"gmail-fix\"] {\r\n\t\tdisplay: none !important;\r\n\t}\r\n\t.es-m-txt-c,\r\n    .es-m-txt-c h1,\r\n    .es-m-txt-c h2,\r\n    .es-m-txt-c h3 {\r\n\t\ttext-align: center !important;\r\n\t}\r\n\t.es-m-txt-r,\r\n    .es-m-txt-r h1,\r\n    .es-m-txt-r h2,\r\n    .es-m-txt-r h3 {\r\n\t\ttext-align: right !important;\r\n\t}\r\n\t.es-m-txt-l,\r\n    .es-m-txt-l h1,\r\n    .es-m-txt-l h2,\r\n    .es-m-txt-l h3 {\r\n\t\ttext-align: left !important;\r\n\t}\r\n\t.es-m-txt-r img,\r\n    .es-m-txt-c img,\r\n    .es-m-txt-l img {\r\n\t\tdisplay: inline !important;\r\n\t}\r\n\t.es-button-border {\r\n\t\tdisplay: block !important;\r\n\t}\r\n\ta.es-button,\r\n    button.es-button {\r\n\t\tfont-size: 16px !important;\r\n\t\tdisplay: block !important;\r\n\t\tborder-left-width: 0px !important;\r\n\t\tborder-right-width: 0px !important;\r\n\t}\r\n\t.es-adaptive table,\r\n    .es-left,\r\n    .es-right {\r\n\t\twidth: 100% !important;\r\n\t}\r\n\t.es-content table,\r\n    .es-header table,\r\n    .es-footer table,\r\n    .es-content,\r\n    .es-footer,\r\n    .es-header {\r\n\t\twidth: 100% !important;\r\n\t\tmax-width: 600px !important;\r\n\t}\r\n\t.es-adapt-td {\r\n\t\tdisplay: block !important;\r\n\t\twidth: 100% !important;\r\n\t}\r\n\t.adapt-img {\r\n\t\twidth: 100% !important;\r\n\t\theight: auto !important;\r\n\t}\r\n\t.es-m-p0 {\r\n\t\tpadding: 0px !important;\r\n\t}\r\n\t.es-m-p0r {\r\n\t\tpadding-right: 0px !important;\r\n\t}\r\n\t.es-m-p0l {\r\n\t\tpadding-left: 0px !important;\r\n\t}\r\n\t.es-m-p0t {\r\n\t\tpadding-top: 0px !important;\r\n\t}\r\n\t.es-m-p0b {\r\n\t\tpadding-bottom: 0 !important;\r\n\t}\r\n\t.es-m-p20b {\r\n\t\tpadding-bottom: 20px !important;\r\n\t}\r\n\t.es-mobile-hidden,\r\n    .es-hidden {\r\n\t\tdisplay: none !important;\r\n\t}\r\n\ttr.es-desk-hidden,\r\n    td.es-desk-hidden,\r\n    table.es-desk-hidden {\r\n\t\twidth: auto !important;\r\n\t\toverflow: visible !important;\r\n\t\tfloat: none !important;\r\n\t\tmax-height: inherit !important;\r\n\t\tline-height: inherit !important;\r\n\t}\r\n\ttr.es-desk-hidden {\r\n\t\tdisplay: table-row !important;\r\n\t}\r\n\ttable.es-desk-hidden {\r\n\t\tdisplay: table !important;\r\n\t}\r\n\ttd.es-desk-menu-hidden {\r\n\t\tdisplay: table-cell !important;\r\n\t}\r\n\t.es-menu td {\r\n\t\twidth: 1% !important;\r\n\t}\r\n\ttable.es-table-not-adapt,\r\n    .esd-block-html table {\r\n\t\twidth: auto !important;\r\n\t}\r\n\ttable.es-social {\r\n\t\tdisplay: inline-block !important;\r\n\t}\r\n\ttable.es-social td {\r\n\t\tdisplay: inline-block !important;\r\n\t}\r\n\t.es-desk-hidden{\r\n\t\tdisplay: table-row !important;\r\n\t\twidth: auto !important;\r\n\t\toverflow: visible !important;\r\n\t\tmax-height: inherit !important;\r\n\t}\r\n}\r\n/* END RESPONSIVE STYLES */\r\n"
      end

      def base_html_string
        "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"><head><meta charset=\"UTF-8\"><meta content=\"width=device-width, initial-scale=1\" name=\"viewport\"><meta name=\"x-apple-disable-message-reformatting\"><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"><meta content=\"telephone=no\" name=\"format-detection\"><title></title><!--[if (mso 16)]>\r\n    <style type=\"text/css\">\r\n    a {text-decoration: none;}\r\n    </style>\r\n    <![endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]>\r\n<xml>\r\n    <o:OfficeDocumentSettings>\r\n    <o:AllowPNG></o:AllowPNG>\r\n    <o:PixelsPerInch>96</o:PixelsPerInch>\r\n    </o:OfficeDocumentSettings>\r\n</xml>\r\n<![endif]--></head><body><div class=\"es-wrapper-color\"><!--[if gte mso 9]>\r\n\t\t\t<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\r\n\t\t\t\t<v:fill type=\"tile\" color=\"#f6f6f6\"></v:fill>\r\n\t\t\t</v:background>\r\n\t\t<![endif]--><table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\"><tbody><tr><td class=\"esd-email-paddings\" valign=\"top\"><table class=\"es-content esd-header-popover\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"><tbody><tr></tr><tr><td class=\"es-adaptive esd-stripe\" esd-custom-block-id=\"8589\" align=\"center\"><table class=\"es-header-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"><tbody><tr><td class=\"esd-structure es-p15t es-p20b es-p20r es-p20l\" style=\"background-color: #ffffff;\" bgcolor=\"#ffffff\" align=\"left\"><!--[if mso]><table width=\"560\" cellpadding=\"0\" cellspacing=\"0\"><tr><td width=\"174\" valign=\"top\"><![endif]--><table class=\"es-left\" cellspacing=\"0\" cellpadding=\"0\" align=\"left\"><tbody><tr><td class=\"es-m-p0r esd-container-frame\" width=\"174\" valign=\"top\" align=\"center\"><table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\"><tbody><tr><td align=\"center\" class=\"esd-empty-container\" style=\"display: none;\"></td></tr></tbody></table></td></tr></tbody></table><!--[if mso]></td><td width=\"20\"></td><td width=\"366\" valign=\"top\"><![endif]--><table cellspacing=\"0\" cellpadding=\"0\" align=\"right\"><tbody><tr><td class=\"esd-container-frame\" width=\"366\" align=\"left\"><table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\"><tbody><tr><td align=\"center\" class=\"esd-empty-container\" style=\"display: none;\"></td></tr></tbody></table></td></tr></tbody></table><!--[if mso]></td></tr></table><![endif]--></td></tr></tbody></table></td></tr></tbody></table><table class=\"es-content\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"><tbody><tr><td class=\"esd-stripe\" esd-custom-block-id=\"8662\" align=\"center\"><table class=\"es-content-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\"><tbody><tr><td class=\"esd-structure es-p20\" align=\"left\"><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td width=\"560\" class=\"esd-container-frame\" align=\"center\" valign=\"top\"><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td align=\"center\" class=\"esd-empty-container\" style=\"display: none;\"></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table><table class=\"es-footer esd-footer-popover\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\"><tbody><tr><td class=\"esd-stripe\" align=\"center\"><table class=\"es-footer-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" bgcolor=\"#ffffff\" style=\"background-color: #ffffff;\"><tbody><tr><td class=\"esd-structure es-p20\" align=\"left\"><!--[if mso]><table width=\"560\" cellpadding=\"0\" cellspacing=\"0\"><tr><td width=\"270\" valign=\"top\"><![endif]--><table cellpadding=\"0\" cellspacing=\"0\" class=\"es-left\" align=\"left\"><tbody><tr><td width=\"270\" class=\"es-m-p20b esd-container-frame\" align=\"left\"><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td align=\"center\" class=\"esd-empty-container\" style=\"display: none;\"></td></tr></tbody></table></td></tr></tbody></table><!--[if mso]></td><td width=\"20\"></td><td width=\"270\" valign=\"top\"><![endif]--><table cellpadding=\"0\" cellspacing=\"0\" class=\"es-right\" align=\"right\"><tbody><tr><td width=\"270\" align=\"left\" class=\"esd-container-frame\"><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td align=\"center\" class=\"esd-empty-container\" style=\"display: none;\"></td></tr></tbody></table></td></tr></tbody></table><!--[if mso]></td></tr></table><![endif]--></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></div></body></html>"
      end

      def email_template_categories
        @email_template_categories ||= (EmailTemplate.categories.map(&:category) << 'Miscellaneous').sort
      end

      def email_templates
        @email_templates ||= EmailTemplate.where(client_id: nil).with_attached_thumbnail.order(:category, :name)
      end

      def image_div_height
        100
      end

      def image_max_height
        60
      end

      def image_max_width
        300
      end

      def merge_tags(client:)
        return @merge_tags if @merge_tags.present?

        response = [
          {
            category: 'HashTags',
            entries:  []
          }
        ]

        ApplicationController.helpers.options_for_hashtag(client:, include_yield_tag: true, include_estimate_hashtags: true, include_invoice_hashtags: true, include_job_hashtags: true, include_subscription_hashtags: true).sort.each do |hashtag|
          response.first[:entries] << { label: hashtag[0], value: hashtag[1] }
        end

        # rubocop:disable Rails/OutputSafety
        @merge_tags = response.to_json.html_safe
      end
      # rubocop:enable Rails/OutputSafety

      def plugin_id
        Rails.application.credentials[:stripo][I18n.t('tenant.id').to_sym][:plugin_id]
      end

      def secret_key
        Rails.application.credentials[:stripo][I18n.t('tenant.id').to_sym][:secret_key]
      end
    end
  end
end
